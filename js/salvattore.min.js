/*! 2013-10-23 */
(function(){!function(a,b){return"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.salvattore=b()}(this,function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return g=[],b=function(a,b,c){var d;return d=a.dataset,d?d[b]=c:a.setAttribute("data-"+b,c)},k=function(a){var b,c,d,e,f,g,h;return c=getComputedStyle(a,":before"),d=c.getPropertyValue("content").slice(1,-1),e=d.match(/^\s*(\d+)(?:\s?\.(.+))?\s*$/),e?(f=e[1],b=(null!=(g=e[2])?g.split("."):void 0)||["column"]):(e=d.match(/^\s*\.(.+)\s+(\d+)\s*$/),b=e[1],f=null!=(h=e[2])?h.split("."):void 0),{numberOfColumns:f,columnClasses:b}},a=function(a,c){var d,e,f,g,h,i,j;for(j=k(a),h=j.numberOfColumns,d=j.columnClasses,f=new Array(+h),console.log("settings",h,d),g=h;0!==g--;)i="[data-columns] > *:nth-child("+h+"n-"+g+")",f.push(c.querySelectorAll(i));return e=document.createDocumentFragment(),f.forEach(function(a){var b,c;return b=document.createElement("div"),b.className=d.join(" "),c=document.createDocumentFragment(),Array.prototype.forEach.call(a,function(a){return c.appendChild(a)}),b.appendChild(c),e.appendChild(b)}),a.appendChild(e),b(a,"columns",h)},o=function(a){var c,d,e,f,g,h;return g=document.createRange(),g.selectNodeContents(a),c=Array.prototype.filter.call(g.extractContents().childNodes,function(a){return a instanceof HTMLElement}),e=c.length,f=c[0].childNodes.length,h=new Array(f*e),Array.prototype.forEach.call(c,function(a,b){return Array.prototype.forEach.call(a.children,function(a,c){return h[c*e+b]=a})}),d=document.createElement("div"),b(d,"columns",0),h.filter(function(a){return null!=a}).forEach(function(a){return d.appendChild(a)}),d},m=function(b){return requestAnimationFrame(function(){var c;return c=o(b),a(b,c)})},h=function(a){return a.matches?Array.prototype.forEach.call(g,m):void 0},e=function(a){var b,c;try{b=a.sheet.cssRules}catch(d){return c=d,[]}return b?b:[]},f=function(){return Array.prototype.concat.call(Array.prototype.slice.call(document.querySelectorAll('style[type="text/css"]')),Array.prototype.slice.call(document.querySelectorAll('link[rel="stylesheet"]')))},i=function(a){var b,c;for(b=a.length;b--;)if(c=a[b],c.selectorText&&c.selectorText.match(/\[data-columns\](.*)::?before$/))return!0;return!1},p=function(){var a;if("undefined"!=typeof matchMedia&&null!==matchMedia)return a=[],f().forEach(function(b){return Array.prototype.forEach.call(e(b),function(b){return null!=b.media&&i(b.cssRules)?a.push(matchMedia(b.media.mediaText)):void 0})}),a.forEach(function(a){return a.addListener(h)})},j=function(a){var b,c,d,e,f,g,h,i;for(c=a.children,g=c.length,f=h=0,i=c.length;i>h&&(b=c[f],d=b.children.length,!(0!==f&&e>d));f=++h){if(f+1===g){f=0;break}e=d}return f},d=function(a){var b,c;for(b=new Array(a),c=0;c!==a;)b[c]=document.createDocumentFragment(),c++;return b},c=function(a,b){var c,e,f,g;return e=a.children,g=e.length,f=d(g),c=j(a,b[0]),b.forEach(function(a){return f[c].appendChild(a),c===g-1?c=0:c++}),Array.prototype.forEach.call(e,function(a,b){return a.appendChild(f[b])})},l=function(a,b){var c,e,f,g,h,i;for(e=a.children,h=e.length,g=d(h),c=h-1,b.forEach(function(a){var b;return b=g[c],b.insertBefore(a,b.firstChild),0===c?c=h-1:c--}),Array.prototype.forEach.call(e,function(a,b){return a.insertBefore(g[b],a.firstChild)}),f=document.createDocumentFragment(),i=b.length%h;0!==i--;)f.appendChild(a.lastChild);return a.insertBefore(f,a.firstChild)},n=function(c){var d,e;if("none"!==getComputedStyle(c).display)return e=document.createRange(),e.selectNodeContents(c),d=document.createElement("div"),d.appendChild(e.extractContents()),b(d,"columns",0),a(c,d),g.push(c)},q=function(){return Array.prototype.forEach.call(document.querySelectorAll("[data-columns]"),n),p()},q(),{append_elements:c,prepend_elements:l,register_grid:n}})}).call(this);